<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Analysis Results ‚Äî Fake News Detector</title>
    <style>
      :root{
        --bg:#121212; --panel:#1E1E1E; --text: #E0E0E0; --muted:#888888; --accent:#0099ff; --accent-2:#33aaff; --neon:#66ccff; --glass:rgba(255,255,255,0.05)
      }
      html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Arial;background:var(--bg);color:var(--text)}
      .frame{display:flex;min-height:100vh}

      /* LEFT NAV */
      .nav{width:280px;padding:22px;display:flex;flex-direction:column;gap:18px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border-right:1px solid rgba(255,255,255,0.05)}
      .logo{width:52px;height:52px;border-radius:12px;background:var(--panel);display:flex;align-items:center;justify-content:center;color:var(--neon);font-weight:900}
      .brand{font-size:18px;font-weight:800;color:var(--text)}
      .menu{display:flex;flex-direction:column;gap:10px;margin-top:8px}
      .menu button{background:transparent;border:0;color:var(--muted);padding:12px;border-radius:8px;text-align:left;cursor:pointer}
      .menu button.active{background:rgba(0, 153, 255, 0.1); color: var(--text);}

      /* MAIN */
      .main{flex:1;display:flex;flex-direction:column}
      .topbar{height:72px;display:flex;align-items:center;justify-content:space-between;padding:0 28px;border-bottom:1px solid rgba(255,255,255,0.05)}
      .top-left{display:flex;gap:14px;align-items:center}
      .top-actions{display:flex;gap:10px;align-items:center}
      .btn{background:var(--panel);padding:8px 12px;border-radius:12px;border:1px solid rgba(255,255,255,0.08);color:var(--muted);cursor:pointer;transition:all 0.2s ease}
      .btn:hover{background:rgba(255,255,255,0.05);color:var(--text)}
      .btn.primary{background:var(--accent);color:#121212;border:0;box-shadow:0 6px 18px rgba(0, 153, 255, 0.1)}

      .content{padding:26px;max-width:1200px;margin:0 auto}
      .analysis-header{display:flex;align-items:center;gap:20px;margin-bottom:30px;padding:24px;background:var(--panel);border-radius:16px;border:1px solid rgba(255,255,255,0.05)}
      .verdict-badge{width:80px;height:80px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;color:#000;box-shadow:inset 0 -6px 18px rgba(0,0,0,0.25)}
      .verdict-badge.green{background:linear-gradient(90deg,#06d17f,#32e6b3)}
      .verdict-badge.yellow{background:linear-gradient(90deg,#f2b237,#ffd97a)}
      .verdict-badge.red{background:linear-gradient(90deg,#ff6a6a,#ff96a0)}
      
      .analysis-grid{display:grid;grid-template-columns:2fr 1fr;gap:24px;margin-bottom:24px}
      .panel{background:var(--panel);border-radius:12px;padding:20px;border:1px solid rgba(255,255,255,0.05)}
      .panel h3{margin:0 0 16px 0;font-size:18px}
      .metric-row{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid rgba(255,255,255,0.05)}
      .metric-row:last-child{border-bottom:none}
      .source-item{background:var(--glass);padding:16px;border-radius:8px;margin-bottom:12px;border-left:3px solid var(--accent)}
      .source-item:last-child{margin-bottom:0}
      
      @media (max-width:768px){ .analysis-grid{grid-template-columns:1fr} .analysis-header{flex-direction:column;text-align:center} }
    </style>
  </head>
  <body>
    <div class="frame">
      <nav class="nav">
        <div style="display:flex;align-items:center;gap:10px">
          <div class="logo">FD</div>
          <div class="brand">Fake News Detection</div>
        </div>
        <div class="menu">
          <button onclick="window.location.href='/'">üìä Dashboard</button>
          <button class="active">üìã Analysis Results</button>
          <button onclick="window.location.href='/'">üîó Sources</button>
          <button onclick="window.location.href='/'">üìë Reports</button>
          <button onclick="window.location.href='/'">‚öôÔ∏è Settings</button>
        </div>
      </nav>

      <main class="main">
        <div class="topbar">
          <div class="top-left">
            <button class="btn" onclick="window.history.back()">‚Üê Back</button>
            <h2 style="margin:0">Analysis Results</h2>
          </div>
          <div class="top-actions">
            <button class="btn" onclick="exportAnalysis()">üì§ Export</button>
            <button class="btn" onclick="shareAnalysis()">üì§ Share</button>
            <button class="btn primary" onclick="window.location.href='/'">New Analysis</button>
          </div>
        </div>

        <div class="content">
          <div class="analysis-header">
            <div id="verdictBadge" class="verdict-badge yellow">
              <div style="font-size:20px;font-weight:800">--</div>
            </div>
            <div style="flex:1">
              <h1 id="verdictTitle" style="margin:0 0 8px 0;font-size:28px">Analysis Result</h1>
              <div id="confidenceLabel" style="color:var(--muted);font-size:16px;margin-bottom:12px">Confidence: --%</div>
              <div id="analysisDate" style="color:var(--muted);font-size:14px"></div>
            </div>
          </div>

          <div class="analysis-grid">
            <div class="panel">
              <h3>üìù Analysis Summary</h3>
              <div id="summaryText" style="line-height:1.6;color:var(--text)"></div>
            </div>
            
            <div class="panel">
              <h3>üéØ Key Metrics</h3>
              <div class="metric-row">
                <span>Credibility Score</span>
                <span id="credibilityScore" style="font-weight:700">--%</span>
              </div>
              <div class="metric-row">
                <span>Risk Level</span>
                <span id="riskLevel" style="font-weight:700">--</span>
              </div>
              <div class="metric-row">
                <span>Content Type</span>
                <span id="contentType" style="font-weight:700">--</span>
              </div>
              <div class="metric-row">
                <span>Sources Found</span>
                <span id="sourcesCount" style="font-weight:700">0</span>
              </div>
            </div>
          </div>

          <div id="sourcesPanel" class="panel" style="display:none">
            <h3>üîó Community Sources</h3>
            <div id="sourcesList"></div>
          </div>

          <div class="panel">
            <h3>‚ö° Quick Actions</h3>
            <div style="display:flex;gap:12px;flex-wrap:wrap">
              <button class="btn" onclick="exportAnalysis()">üì§ Export Report</button>
              <button class="btn" onclick="shareAnalysis()">üì§ Share Analysis</button>
              <button class="btn" onclick="flagContent()">üö© Flag Content</button>
              <button class="btn" onclick="window.location.href='/'">üîÑ New Analysis</button>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script>
      // Get analysis data from URL parameters or localStorage
      function getAnalysisData() {
        const urlParams = new URLSearchParams(window.location.search);
        const analysisId = urlParams.get('id');
        
        if (analysisId) {
          // Try to get from localStorage first
          const stored = localStorage.getItem('analysis_' + analysisId);
          if (stored) {
            return JSON.parse(stored);
          }
        }
        
        // Fallback to URL parameters
        return {
          verdict: urlParams.get('verdict') || 'Unknown',
          confidence: parseFloat(urlParams.get('confidence')) || 0,
          summary: urlParams.get('summary') || 'No summary available',
          content_type: urlParams.get('content_type') || 'Text',
          sources: JSON.parse(urlParams.get('sources') || '[]'),
          created_at: urlParams.get('created_at') || new Date().toISOString()
        };
      }

      function displayAnalysis() {
        const data = getAnalysisData();
        const confidence = Math.round(data.confidence * 100);
        
        // Update verdict badge
        const badge = document.getElementById('verdictBadge');
        badge.className = `verdict-badge ${confidence > 70 ? 'green' : confidence > 40 ? 'yellow' : 'red'}`;
        badge.innerHTML = `<div style="font-size:20px;font-weight:800">${confidence}%</div>`;
        
        // Update content
        document.getElementById('verdictTitle').textContent = data.verdict;
        document.getElementById('confidenceLabel').textContent = `Confidence: ${confidence}%`;
        document.getElementById('analysisDate').textContent = `Analyzed on ${new Date(data.created_at).toLocaleString()}`;
        document.getElementById('summaryText').textContent = data.summary;
        
        // Update metrics
        document.getElementById('credibilityScore').textContent = `${confidence}%`;
        document.getElementById('riskLevel').textContent = confidence > 70 ? 'Low' : confidence > 40 ? 'Medium' : 'High';
        document.getElementById('riskLevel').style.color = confidence > 70 ? '#06d17f' : confidence > 40 ? '#f2b237' : '#ff6a6a';
        document.getElementById('contentType').textContent = data.content_type;
        document.getElementById('sourcesCount').textContent = data.sources?.length || 0;
        
        // Display sources if available
        if (data.sources && data.sources.length > 0) {
          const sourcesPanel = document.getElementById('sourcesPanel');
          const sourcesList = document.getElementById('sourcesList');
          
          sourcesList.innerHTML = data.sources.map(source => `
            <div class="source-item">
              <div style="font-weight:600;margin-bottom:4px">
                <a href="${source.url}" target="_blank" style="color:var(--accent);text-decoration:none">${source.site || 'Source'}</a>
              </div>
              <div style="color:var(--muted);font-size:14px">${source.title || 'No title available'}</div>
            </div>
          `).join('');
          
          sourcesPanel.style.display = 'block';
        }
      }

      function exportAnalysis() {
        alert('Export functionality coming soon!');
      }
      
      function shareAnalysis() {
        if (navigator.share) {
          navigator.share({
            title: 'Fake News Analysis Result',
            text: `Analysis shows: ${document.getElementById('verdictTitle').textContent}`,
            url: window.location.href
          });
        } else {
          // Fallback: copy to clipboard
          navigator.clipboard.writeText(window.location.href);
          alert('Analysis link copied to clipboard!');
        }
      }
      
      function flagContent() {
        alert('Content flagged for review. Thank you for helping improve our system!');
      }

      // Initialize page
      displayAnalysis();
    </script>
  </body>
</html>
